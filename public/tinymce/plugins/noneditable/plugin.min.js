tinymce.PluginManager.add("noneditable",function(e){function t(e){var t;if(1===e.nodeType){t=e.getAttribute(d);if(t&&"inherit"!==t)return t;t=e.contentEditable;if("inherit"!==t)return t}return null}function n(e){for(var n;e;){n=t(e);if(n)return"false"===n?e:null;e=e.parentNode}}function r(){function r(e){for(;e;){if(e.id===p)return e;e=e.parentNode}}function i(e){var t;if(e){t=new l(e,e);for(e=t.current();e;e=t.next())if(3===e.nodeType)return e}}function o(n,r){var i,o;if("false"!==t(n)||!d.isBlock(n)){o=d.createRng();if("true"===t(n)){n.firstChild||n.appendChild(e.getDoc().createTextNode("Â "));n=n.firstChild;r=!0}i=d.create("span",{id:p,"data-mce-bogus":!0},h);r?n.parentNode.insertBefore(i,n):d.insertAfter(i,n);o.setStart(i.firstChild,1);o.collapse(!0);f.setRng(o);return i}f.select(n)}function a(e){var t,n,r;if(e){t=f.getRng(!0);t.setStartBefore(e);t.setEndBefore(e);n=i(e);n&&n.nodeValue.charAt(0)==h&&(n=n.deleteData(0,1));d.remove(e,!0);f.setRng(t)}else for(;(e=d.get(p))&&e!==r;){n=i(e);n&&n.nodeValue.charAt(0)==h&&(n=n.deleteData(0,1));d.remove(e,!0);r=e}}function s(){function e(e,n){var r,i,o,a,s;r=c.startContainer;i=c.startOffset;if(3==r.nodeType){s=r.nodeValue.length;if(i>0&&i<s||(n?i==s:0===i))return}else{if(!(i<r.childNodes.length))return n?null:e;var d=!n&&i>0?i-1:i;r=r.childNodes[d];r.hasChildNodes()&&(r=r.firstChild)}o=new l(r,e);for(;a=o[n?"prev":"next"]();){if(3===a.nodeType&&a.nodeValue.length>0)return;if("true"===t(a))return a}return e}var r,i,s,c,d;a();s=f.isCollapsed();r=n(f.getStart());i=n(f.getEnd());if(r||i){c=f.getRng(!0);if(s){r=r||i;(d=e(r,!0))?o(d,!0):(d=e(r,!1))?o(d,!1):f.select(r)}else{c=f.getRng(!0);r&&c.setStartBefore(r);i&&c.setEndAfter(i);f.setRng(c)}}}function c(i){function o(e,t){for(;e=e[t?"previousSibling":"nextSibling"];)if(3!==e.nodeType||e.nodeValue.length>0)return e}function c(e,t){f.select(e);f.collapse(t)}function p(i){function o(e){for(var t=c;t;){if(t===e)return;t=t.parentNode}d.remove(e);s()}function a(){var r,a,s=e.schema.getNonEmptyElements();a=new tinymce.dom.TreeWalker(c,e.getBody());for(;(r=i?a.prev():a.next())&&!s[r.nodeName.toLowerCase()]&&!(3===r.nodeType&&tinymce.trim(r.nodeValue).length>0);)if("false"===t(r)){o(r);return!0}return!!n(r)}var l,c,u,p;if(f.isCollapsed()){l=f.getRng(!0);c=l.startContainer;u=l.startOffset;c=r(c)||c;if(p=n(c)){o(p);return!1}if(3==c.nodeType&&(i?u>0:u<c.nodeValue.length))return!0;1==c.nodeType&&(c=c.childNodes[u]||c);if(a())return!1}return!0}var h,m,g,v,y=i.keyCode;s();g=f.getStart();v=f.getEnd();h=n(g)||n(v);var b=e.selection.getNode(),C=y==u.LEFT||y==u.RIGHT||y==u.UP||y==u.DOWN,x=y==u.LEFT||y==u.UP;if(h&&(y<112||y>124)&&y!=u.DELETE&&y!=u.BACKSPACE){if((tinymce.isMac?i.metaKey:i.ctrlKey)&&(67==y||88==y||86==y))return;i.preventDefault();if(C)if(e.dom.isBlock(h)){var w=x?h.previousSibling:h.nextSibling;if(!w||w&&"false"===t(w)){var _=d.create("p",null,"&nbsp;");_.className="mceTmpParagraph";var E=x?h:w;E&&E.parentNode?E.parentNode.insertBefore(_,E):w||x||h.parentNode.appendChild(_);w=_}var N=new l(w,w),k=x?N.prev():N.next();c(k,!x)}else c(h,x)}else if(C||y==u.BACKSPACE||y==u.DELETE){m=r(g);if(m){if(y==u.LEFT||y==u.BACKSPACE){h=o(m,!0);if(h&&"false"===t(h)){i.preventDefault();if(y!=u.LEFT){d.remove(h);return}c(h,!0)}else a(m)}if(y==u.RIGHT||y==u.DELETE){h=o(m,!0);if(h&&"false"===t(h)){i.preventDefault();if(y!=u.RIGHT){d.remove(h);return}c(h,!1)}else a(m)}}else{if(C&&b&&b.className.indexOf("mceTmpParagraph")!==-1&&b[x?"previousSibling":"nextSibling"]){var S=b[x?"previousSibling":"nextSibling"];"&nbsp;"===b.innerHTML||""===b.innerHTML||" "===b.innerHTML?d.remove(b):b.className=b.className.replace("mceTmpParagraph","");c(S,!x)}var T=f.getRng(!0),R=T.endContainer;d.isBlock(R)&&d.isBlock(R.nextSibling)&&1==T.endOffset&&y==u.DELETE&&(h=n(R.nextSibling));if(h&&(y==u.DELETE||y==u.BACKSPACE)&&d.isBlock(h)){i.preventDefault();d.remove(h);return}}if((y==u.BACKSPACE||y==u.DELETE)&&!p(y==u.BACKSPACE)){i.preventDefault();return!1}}}var d=e.dom,f=e.selection,p="mce_noneditablecaret",h="\ufeff";e.on("mousedown",function(n){var r=e.selection.getNode();r&&r.className.indexOf("mceTmpParagraph")!==-1&&r!==n.target&&("&nbsp;"===r.innerHTML||""===r.innerHTML||" "===r.innerHTML?d.remove(r):r.className=r.className.replace("mceTmpParagraph",""));"false"===t(r)&&r==n.target&&s()});e.on("mouseup",s);e.on("keydown",c)}function i(t){var n=s.length,r=t.content,i=tinymce.trim(a);if("raw"!=t.format){for(;n--;)r=r.replace(s[n],function(t){var n=arguments,o=n[n.length-2];return o>0&&'"'==r.charAt(o-1)?t:'<span class="'+i+'" data-mce-content="'+e.dom.encode(n[0])+'">'+e.dom.encode("string"==typeof n[1]?n[1]:n[0])+"</span>"});t.content=r}}var o,a,s,l=tinymce.dom.TreeWalker,c="contenteditable",d="data-mce-"+c,u=tinymce.util.VK;o=" "+tinymce.trim(e.getParam("noneditable_editable_class","mceEditable"))+" ";a=" "+tinymce.trim(e.getParam("noneditable_noneditable_class","mceNonEditable"))+" ";s=e.getParam("noneditable_regexp");s&&!s.length&&(s=[s]);e.on("PreInit",function(){r();s&&e.on("BeforeSetContent",i);e.parser.addAttributeFilter("class",function(e){for(var t,n,r=e.length;r--;){n=e[r];t=" "+n.attr("class")+" ";t.indexOf(o)!==-1?n.attr(d,"true"):t.indexOf(a)!==-1&&n.attr(d,"false")}});e.serializer.addAttributeFilter(d,function(e){for(var t,n=e.length;n--;){t=e[n];if(s&&t.attr("data-mce-content")){t.name="#text";t.type=3;t.raw=!0;t.value=t.attr("data-mce-content")}else{t.attr(c,null);t.attr(d,null)}}});e.parser.addAttributeFilter(c,function(e){for(var t,n=e.length;n--;){t=e[n];t.attr(d,t.attr(c));t.attr(c,null)}})});e.on("drop",function(e){n(e.target)&&e.preventDefault()})});