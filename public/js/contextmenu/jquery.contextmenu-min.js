LEA.cmroot=1,function(t){function i(){return!1}t.fn.contextmenu=function(e){function n(t){for(var i in m)s(i,!t.disable);for(var i=0;i<t.items.length;i++)s(t.items[i],t.disable);u=t.name}function s(t,i){var e=m[t];if(!e){var e={};return e.className=(e.disable=i)?"b-m-idisable":"b-m-item",void(m[t]=e)}e.className=(e.disable=i)?"b-m-idisable":"b-m-item"}function a(i,e){E(),o(),r=e,L.call(d[c],{left:i.pageX,top:i.pageY},0),r&&!t(r).hasClass("item-active")&&t(r).addClass("contextmenu-hover")}function l(i){var n=!e.onContextMenu||!t.isFunction(e.onContextMenu)||e.onContextMenu.call(this,i);return n&&(e.onShow&&t.isFunction(e.onShow)&&e.onShow.call(this,I),I.showMenu(i,this)),i&&i.preventDefault(),!1}function o(){Note.$itemList.find("li").removeClass("contextmenu-hover")}var c="contextmenu"+LEA.cmroot;LEA.cmroot++,e=t.extend({alias:c,width:150},e);var u=null,r=null,d={},m={},h={},p=[],f='<div class="b-m-$[type]" unselectable="on"><div class="clearfix cm-item"><div class="b-m-icon pull-left"><i class="fa $[faIcon]"></i>$[imgIcon]</div><div class="pull-left cm-text"><span class="c-text" unselectable="on">$[text]</span></div></div></div>';itemNoIconTpl="<div class='b-m-$[type]' unselectable=on><nobr unselectable=on><span align='absmiddle'></span><span class='c-text' unselectable=on>$[text]</span></nobr></div>";var b=t("<div/>").addClass("b-m-mpanel").attr("unselectable","on").css("display","none"),v=t("<div/>").addClass("b-m-item").attr("unselectable","on"),x=t("<div/>").addClass("b-m-split"),g=t("body"),y={},w=function(e){return d[e.alias]=this,this.gidx=e.alias,this.id=e.alias,e.disable&&(this.disable=e.disable,this.className="b-m-idisable"),t(this).width(e.width).on("click",function(){}).on("mousedown",i).appendTo(g),e=null,this},C=function(t){var i=this;i.title=t.text,i.idx=t.alias,i.gidx=t.gidx,i.data=t;var e="";return t.icon&&(e='<img src="'+t.icon+'"/>'),t.imgIcon=e,t.icon?i.innerHTML=f.replace(/\$\[([^\]]+)\]/g,function(){return t[arguments[1]]}):i.innerHTML=f.replace(/\$\[([^\]]+)\]/g,function(){return t[arguments[1]]}),(t.disable||m[t.alias]&&m[t.alias].disable)&&(i.disable=!0,i.className="b-m-idisable"),t.items&&(i.group=!0),t.action&&(h[t.alias]=t.action),m[t.alias]=i,i=t=null,this},N=function(e,n,s){for(var a=null,l=n.length,o=0;o<l;o++){var c=n[o];if("splitLine"==c.type)a=x.clone()[0];else{if(c.alias||(s?c.alias=s+"."+c.text:c.alias=c.text),c.gidx=e,"group"!=c.type||c.action){"group"==c.type?(w.apply(b.clone()[0],[c]),y[c.alias]=c.items,c.type="arrow",a=C.apply(v.clone()[0],[c])):(c.type="ibody",a=C.apply(v.clone()[0],[c]));var u=c;!function(i,e){t(e).on("click",function(e){return this.disable||(t.isFunction(h[this.idx])&&h[this.idx].call(this,r,i),E(),t(r).removeClass("contextmenu-hover")),!1})}(u,a)}else w.apply(b.clone()[0],[c]),y[c.alias]=c.items,c.type="arrow",a=C.apply(v.clone()[0],[c]);t(a).on("contextmenu",i).on("mouseenter",$).on("mouseleave",M)}d[e].appendChild(a),a=c=c.items=null}e=n=null},$=function(i){if(!this.group&&this.disable)return!1;if(E.call(d[this.gidx]),this.group){var e=t(this).offset(),n=t(this).outerWidth();L.apply(d[this.idx],[e,n,this])}return this.className="b-m-ifocus",!1},M=function(t){return this.group||this.disable||(this.className="b-m-item"),!1},L=function(i,e,n){var s=t(this);""==s.html()&&N(n.idx,y[n.idx],n.idx);var a=g.width(),l=document.documentElement.clientHeight-10;l=l<0?100:l;var o=t(this).outerWidth(),c=t(this).outerHeight()-10;c=c<0?100:c;var o=t(this).outerWidth();i.left=i.left+e+o>a?i.left-o<0?0:i.left-o:i.left+e,i.top=i.top+c>l?i.top-c+(e>0?25:0)<0?0:i.top-c+(e>0?25:0):i.top,t(this).css(i).show().css("max-height",l),p.push(this.gidx)},E=function(){for(var t=null,i=p.length-1;i>=0&&p[i]!=this.gidx;i--)t=p.pop(),d[t].style.display="none",m[t]&&(m[t].disable?m[t].className="b-m-idisable":m[t].className="b-m-item")},H=t("#"+e.alias),I=null;0==H.length?(I=w.apply(b.clone()[0],[e]),I.applyrule=n,I.showMenu=a,N(e.alias,e.items)):I=H[0];var T=t(e.parent).on("contextmenu",e.children,function(t){l.call(this,t)});t("body").on("click",function(t){o(),E()}),e.rule&&n(e.rule);var k={destroy:function(){T.off("contextmenu")},showMenu:function(t,i){l.call(i,t)}};return k}}(jQuery);